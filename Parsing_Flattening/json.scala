import org.json4s._
import org.json4s.jackson.JsonMethods._
implicit val formats = DefaultFormats
 
case class Account(accountType: String, accountNumber: String, accountName: String, currency: String, accountStatus: String)
case class Broker(accounts: List[Account])
case class PortfolioByBroker(brokers: List[Broker])
case class accountPE(portfolioByBroker: PortfolioByBroker)
 
val lotto1 = parse("""{"userId":"8e22b01a-8088-4543-a248-26c354e56dd8","organizationId":"nextgenbank","userIdentified":{"userId":"8e22b01a-8088-4543-a248-26c354e56dd8","externalId":{"string":"7d6b6e7e-3fe9-471b-bd1b-cf1c706ff865"},"organizationId":"nextgen","username":"blackgorilla503","firstName":"ثنا","lastName":"کریمی","emailAddress":"ثنا.کریمی@example.com","userStatus":{"lastIssueDate":"2018-05-11T22:55:03.113Z","userSince":"2013-08-15T02:20:05.000Z","registeredForAggr":false,"lastAggregation":null,"lastManualUpdate":null,"billingState":"BILLING_FREE","userFlowStatus":{"hasGoal":false,"hasPortfolio":false,"viewedAssetAllocation":false,"viewedActionPlan":false,"hasCompletedSandboxGoal":false,"signingCeremonyInProgress":false}},"accessMeta":{"clientAddr":"192.168.1.1","remoteAddr":"192.168.1.1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X x.y; rv:42.0) Gecko/20100101 Firefox/42.0","proto":"https","host":"nextgenbank.jemstep.com","uri":"/","method":"GET","referrer":"none"},"seoCampaign":{"source":"source","campaign":"campaign","medium":"medium","keyword":"keyword","adContent":"adContent","adClickId":"adClickId"}},"goal":{"id":"5af61f47e4b0be41f1b97984","goalObjective":"RETIREMENT","goalType":"MAIN","properties":{"goalName":"My Retirement Goal","created":"2013-08-15T02:20:05.000Z","updated":"2018-05-11T22:55:03.113Z"},"questionnaire":{"com.jemstep.model.questionnaire.ModelQuestionnaire":{"questions":[{"questionId":"riskRelatedToInvestment","answer":{"string":"I understand that some level of risk is part of the investing process."}},{"questionId":"timeFrameObjective","answer":{"string":"10 to 15 years"}},{"questionId":"timeFrameWithdrawal","answer":{"string":"Not for at least 10 years"}},{"questionId":"withdrawalRequirement","answer":{"string":"2% to 4% per year"}},{"questionId":"investmentAttitude","answer":{"string":"My only goal is to grow the value of the account over time and I am willing to accept reasonable fluctuations in my account value."}},{"questionId":"marketDropReaction","answer":{"string":"Keep all of my investments considering my long-term investment goals and the principle of asset allocation."}},{"questionId":"futureIncomeConfidence","answer":{"string":"Somewhat stable"}}]}},"relatedGoalId":null,"overrideTargetModel":{"string":"ModerateAggressive"}},"modelQuestionnaire":{"questions":[{"questionId":"incomeTaxRate","answer":{"string":"0.35"}},{"questionId":"netWorth","answer":{"string":"2000000"}}]},"portfolioByBroker":{"brokers":[{"name":"Charles Schwab","aggregation":false,"accounts":[{"accountType":"TaxableRetirement","accountNumber":"XXXXX-1232-56","accountName":"Test Account 47","currency":"USD","accountStatus":"HeldAway","totalBalance":971969.6547122468,"cashBalance":1244.603802059837,"uuid":{"string":"60e6d1d1-3e6e-40f0-a9a2-43f68a577855"},"goalIds":["5af61f47e4b0be41f1b97984"],"dollarValue":389764.5108958292,"portfolioPercent":100.0,"positions":[{"ticker":{"string":"SPY"},"description":"SPDR S&P 500 ETF Trust","units":51.0,"unitPrice":76.52218814358784,"currency":"USD","costBasis":{"double":100.0},"product":{"string":"MutualFund"},"productId":{"int":10516712},"allocations":{"T2_US_LARGE_CAP":100.0},"uuid":{"string":"26e7f345-912a-429f-b017-66af44f0fe05"},"update":{"string":"2018-05-11T22:55:03.113Z"},"created":"2018-05-11T22:55:03.113Z","dollarValue":666.1561334962785,"assetClass":{"string":"T3_STOCK_US_LARGE_CAP"},"portfolioPercent":0.0,"cusip":{"string":"105712"},"assetClassName":{"com.jemstep.model.util.Message":{"key":"U.S. Large Cap Stocks","args":[]}},"purchaseDate":{"string":"2018-05-11T22:55:03.113Z"},"flags":null,"sourceData":null}],"update":{"string":"2018-05-11T22:55:03.113Z"},"created":"2018-05-11T22:55:03.113Z","error":null,"flags":{"com.jemstep.model.portfolio.AccountFlags":{"taxable":true,"ignore":false,"lock":false,"lockByDefault":false,"selfDirected":{"boolean":true},"discretionary":false,"enrolled":false}},"ownership":"Individual","accountIntegrations":{"integrationsEnabled":true,"orion":{"com.jemstep.model.integration.orion.Orion":{"accountId":5,"registrationId":10,"clientId":10,"advisorOverride":{"model":{"com.jemstep.model.integration.orion.ModelAggId":{"id":5}},"managementStyle":{"com.jemstep.model.integration.orion.ManagementStyleId":{"id":5}}},"created":"2018-05-11T22:55:00.384Z"}},"pershing":{"com.jemstep.model.integration.pershing.PershingIntegrations":{"mi":{"com.jemstep.model.integration.pershing.PershingMIIntegration":{"state":"PershingMIAwaitingSetup","currentModel":{"string":"sax"},"currentLastUpdated":{"string":"2018-05-11T22:55:00.383Z"},"pendingModel":{"string":"xaxx"},"pendingSince":{"string":"2018-05-11T22:55:00.383Z"},"confirmedModel":{"string":"axaxax"},"lastConfirmed":{"string":"2018-05-11T22:55:00.383Z"}}},"enrollment":{"com.jemstep.model.integration.pershing.PershingEnrollmentIntegration":{"repCode":"accc","accountNumberPrefix":"cscscc"}}}}},"contributionPlan":{"employerName":{"string":"sdsdd"},"employerEin":{"string":"dasd"},"employerId":{"string":"323313"},"planId":{"int":3},"planName":{"string":"sadsadad"},"eligibleForRollover":false},"isRollover":{"boolean":true}},{"accountType":"TaxableRetirement","accountNumber":"XXXXX-1232-18","accountName":"Test Account 3","currency":"USD","accountStatus":"HeldAway","totalBalance":839486.9240800005,"cashBalance":3707.3514573960074,"uuid":{"string":"fbd7cba0-cc0b-4da6-87bd-7ecf60471401"},"goalIds":["5af61f47e4b0be41f1b97984"],"dollarValue":765905.0705868241,"portfolioPercent":100.0,"positions":[{"ticker":{"string":"SPY"},"description":"SPDR S&P 500 ETF Trust","units":27.0,"unitPrice":237.54700715944622,"currency":"USD","costBasis":{"double":100.0},"product":{"string":"MutualFund"},"productId":{"int":10516712},"allocations":{"T2_US_LARGE_CAP":100.0},"uuid":{"string":"26e7f345-912a-429f-b017-66af44f0fe05"},"update":{"string":"2018-05-11T22:55:03.113Z"},"created":"2018-05-11T22:55:03.113Z","dollarValue":12489.439042128575,"assetClass":{"string":"T3_STOCK_US_LARGE_CAP"},"portfolioPercent":0.0,"cusip":{"string":"105712"},"assetClassName":{"com.jemstep.model.util.Message":{"key":"U.S. Large Cap Stocks","args":[]}},"purchaseDate":{"string":"2018-05-11T22:55:03.113Z"},"flags":null,"sourceData":null}],"update":{"string":"2018-05-11T22:55:03.113Z"},"created":"2018-05-11T22:55:03.113Z","error":null,"flags":{"com.jemstep.model.portfolio.AccountFlags":{"taxable":true,"ignore":false,"lock":false,"lockByDefault":false,"selfDirected":{"boolean":true},"discretionary":false,"enrolled":false}},"ownership":"Individual","accountIntegrations":{"integrationsEnabled":true,"orion":{"com.jemstep.model.integration.orion.Orion":{"accountId":5,"registrationId":10,"clientId":10,"advisorOverride":{"model":{"com.jemstep.model.integration.orion.ModelAggId":{"id":5}},"managementStyle":{"com.jemstep.model.integration.orion.ManagementStyleId":{"id":5}}},"created":"2018-05-11T22:55:00.384Z"}},"pershing":{"com.jemstep.model.integration.pershing.PershingIntegrations":{"mi":{"com.jemstep.model.integration.pershing.PershingMIIntegration":{"state":"PershingMIAwaitingSetup","currentModel":{"string":"sax"},"currentLastUpdated":{"string":"2018-05-11T22:55:00.383Z"},"pendingModel":{"string":"xaxx"},"pendingSince":{"string":"2018-05-11T22:55:00.383Z"},"confirmedModel":{"string":"axaxax"},"lastConfirmed":{"string":"2018-05-11T22:55:00.383Z"}}},"enrollment":{"com.jemstep.model.integration.pershing.PershingEnrollmentIntegration":{"repCode":"accc","accountNumberPrefix":"cscscc"}}}}},"contributionPlan":{"employerName":{"string":"sdsdd"},"employerEin":{"string":"dasd"},"employerId":{"string":"323313"},"planId":{"int":3},"planName":{"string":"sadsadad"},"eligibleForRollover":false},"isRollover":{"boolean":true}}],"url":{"string":"https://www.schwab.co"},"hasImage":false,"uuid":"626ccc37-c94f-43b0-9324-720fbe7a60a8","dollarValue":564015.8959027324,"portfolioPercent":9.211049211293753,"update":{"string":"2018-05-11T22:55:03.113Z"},"created":"2018-05-11T22:55:03.113Z","fiId":{"int":3},"error":null,"showErrorAlert":{"boolean":false}},{"name":"E*Trade Financial","aggregation":false,"accounts":[{"accountType":"TaxableRetirement","accountNumber":"XXXXX-1232-91","accountName":"Test Account 78","currency":"USD","accountStatus":"HeldAway","totalBalance":933422.0005838585,"cashBalance":1244.912292810142,"uuid":{"string":"9c543fda-9602-4e9b-994a-c751872eb95a"},"goalIds":["5af61f47e4b0be41f1b97984"],"dollarValue":443136.3354671751,"portfolioPercent":100.0,"positions":[{"ticker":{"string":"SPY"},"description":"SPDR S&P 500 ETF Trust","units":10.0,"unitPrice":190.69281681993027,"currency":"USD","costBasis":{"double":100.0},"product":{"string":"MutualFund"},"productId":{"int":10516712},"allocations":{"T2_US_LARGE_CAP":100.0},"uuid":{"string":"26e7f345-912a-429f-b017-66af44f0fe05"},"update":{"string":"2018-05-11T22:55:03.113Z"},"created":"2018-05-11T22:55:03.113Z","dollarValue":4031.7497625324645,"assetClass":{"string":"T3_STOCK_US_LARGE_CAP"},"portfolioPercent":0.0,"cusip":{"string":"105712"},"assetClassName":{"com.jemstep.model.util.Message":{"key":"U.S. Large Cap Stocks","args":[]}},"purchaseDate":{"string":"2018-05-11T22:55:03.113Z"},"flags":null,"sourceData":null}],"update":{"string":"2018-05-11T22:55:03.113Z"},"created":"2018-05-11T22:55:03.113Z","error":null,"flags":{"com.jemstep.model.portfolio.AccountFlags":{"taxable":true,"ignore":false,"lock":false,"lockByDefault":false,"selfDirected":{"boolean":true},"discretionary":false,"enrolled":false}},"ownership":"Individual","accountIntegrations":{"integrationsEnabled":true,"orion":{"com.jemstep.model.integration.orion.Orion":{"accountId":5,"registrationId":10,"clientId":10,"advisorOverride":{"model":{"com.jemstep.model.integration.orion.ModelAggId":{"id":5}},"managementStyle":{"com.jemstep.model.integration.orion.ManagementStyleId":{"id":5}}},"created":"2018-05-11T22:55:00.384Z"}},"pershing":{"com.jemstep.model.integration.pershing.PershingIntegrations":{"mi":{"com.jemstep.model.integration.pershing.PershingMIIntegration":{"state":"PershingMIAwaitingSetup","currentModel":{"string":"sax"},"currentLastUpdated":{"string":"2018-05-11T22:55:00.383Z"},"pendingModel":{"string":"xaxx"},"pendingSince":{"string":"2018-05-11T22:55:00.383Z"},"confirmedModel":{"string":"axaxax"},"lastConfirmed":{"string":"2018-05-11T22:55:00.383Z"}}},"enrollment":{"com.jemstep.model.integration.pershing.PershingEnrollmentIntegration":{"repCode":"accc","accountNumberPrefix":"cscscc"}}}}},"contributionPlan":{"employerName":{"string":"sdsdd"},"employerEin":{"string":"dasd"},"employerId":{"string":"323313"},"planId":{"int":3},"planName":{"string":"sadsadad"},"eligibleForRollover":false},"isRollover":{"boolean":true}},{"accountType":"TaxableRetirement","accountNumber":"XXXXX-1232-80","accountName":"Test Account 75","currency":"USD","accountStatus":"HeldAway","totalBalance":988933.7339811219,"cashBalance":9666.781864348153,"uuid":{"string":"9163995d-e2d4-4606-b3bd-06a29a3f2157"},"goalIds":["5af61f47e4b0be41f1b97984"],"dollarValue":122146.4445485444,"portfolioPercent":100.0,"positions":[{"ticker":{"string":"SPY"},"description":"SPDR S&P 500 ETF Trust","units":26.0,"unitPrice":189.3951213449244,"currency":"USD","costBasis":{"double":100.0},"product":{"string":"MutualFund"},"productId":{"int":10516712},"allocations":{"T2_US_LARGE_CAP":100.0},"uuid":{"string":"26e7f345-912a-429f-b017-66af44f0fe05"},"update":{"string":"2018-05-11T22:55:03.113Z"},"created":"2018-05-11T22:55:03.113Z","dollarValue":7574.487169655255,"assetClass":{"string":"T3_STOCK_US_LARGE_CAP"},"portfolioPercent":0.0,"cusip":{"string":"105712"},"assetClassName":{"com.jemstep.model.util.Message":{"key":"U.S. Large Cap Stocks","args":[]}},"purchaseDate":{"string":"2018-05-11T22:55:03.113Z"},"flags":null,"sourceData":null}],"update":{"string":"2018-05-11T22:55:03.113Z"},"created":"2018-05-11T22:55:03.113Z","error":null,"flags":{"com.jemstep.model.portfolio.AccountFlags":{"taxable":true,"ignore":false,"lock":false,"lockByDefault":false,"selfDirected":{"boolean":true},"discretionary":false,"enrolled":false}},"ownership":"Individual","accountIntegrations":{"integrationsEnabled":true,"orion":{"com.jemstep.model.integration.orion.Orion":{"accountId":5,"registrationId":10,"clientId":10,"advisorOverride":{"model":{"com.jemstep.model.integration.orion.ModelAggId":{"id":5}},"managementStyle":{"com.jemstep.model.integration.orion.ManagementStyleId":{"id":5}}},"created":"2018-05-11T22:55:00.384Z"}},"pershing":{"com.jemstep.model.integration.pershing.PershingIntegrations":{"mi":{"com.jemstep.model.integration.pershing.PershingMIIntegration":{"state":"PershingMIAwaitingSetup","currentModel":{"string":"sax"},"currentLastUpdated":{"string":"2018-05-11T22:55:00.383Z"},"pendingModel":{"string":"xaxx"},"pendingSince":{"string":"2018-05-11T22:55:00.383Z"},"confirmedModel":{"string":"axaxax"},"lastConfirmed":{"string":"2018-05-11T22:55:00.383Z"}}},"enrollment":{"com.jemstep.model.integration.pershing.PershingEnrollmentIntegration":{"repCode":"accc","accountNumberPrefix":"cscscc"}}}}},"contributionPlan":{"employerName":{"string":"sdsdd"},"employerEin":{"string":"dasd"},"employerId":{"string":"323313"},"planId":{"int":3},"planName":{"string":"sadsadad"},"eligibleForRollover":false},"isRollover":{"boolean":true}}],"url":{"string":"https://us.etrade.com/home"},"hasImage":false,"uuid":"057ff283-ddd1-43b4-a593-8dea329b6f5e","dollarValue":799273.2585534542,"portfolioPercent":70.04674352606406,"update":{"string":"2018-05-11T22:55:03.113Z"},"created":"2018-05-11T22:55:03.113Z","fiId":{"int":3},"error":null,"showErrorAlert":{"boolean":false}}],"dollarValue":0.0,"portfolioPercent":100.0},"backtestMetrics":{"currentAnnualizedReturn":17.973316548517687,"targetAnnualizedReturn":19.53029002179197,"currentBestYearPercentage":0.25394365509486594,"currentBestYear":-356284014,"targetBestYearPercentage":6.270194254801074,"targetBestYear":-1529821075,"currentWorstYearPercentage":15.734452828718766,"currentWorstYear":593400296,"targetWorstYearPercentage":0.23142612955990627,"targetWorstYear":-991818694,"currentYearsWithLosses":-1375246026,"targetYearsWithLosses":1123905263,"currentExpenseRatio":18.395927859469897,"costOfFeesOnCurrentPortfolio":1.8037640525504561,"targetExpenseRatio":18.534552011447317,"costOfFeesOnTargetPortfolio":17.352177424953055,"opportunityFeeSaving20Yrs":0.0,"actualFeeSavingAnnual":0.0,"actualFeeSaving15Yrs":0.0}}""")
 

lotto1.extract[accountPE]